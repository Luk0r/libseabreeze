# Test build
dependencies:
  pre:
    - sudo apt-get update
    - sudo apt-get install libusb-dev

compile:
  override:
    - make lib/libseabreeze.so:
        pwd:
          SeaBreeze
    - tar czf ${CIRCLE_TAG}.tar.gz lib/libseabreeze.so:
        pwd:
          SeaBreeze

test:
  override:
    - "true"

# Define artifacts
general:
  artifacts:
    - "SeaBreeze/${CIRCLE_TAG}.tar.gz"

deployment:
  release:
    tag: /libseabreeze-.*/
    owner: ap--
    commands:
        - go get github.com/aktau/github-release
        - github-release upload --user "ap--" --repo libseabreeze --tag ${CIRCLE_TAG} --file "SeaBreeze/${CIRCLE_TAG}.tar.gz"
